<!DOCTYPE html>
<html lang="en">
<head>
    <title>Title</title>
    <meta charset="utf-8">
    <style>
        th,td{
        padding:3px;
        }
        #header_content {
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="header_content">
        <h2>
        Report for the web-site
        </h2>
    </div>
    <div>
        {% now "SHORT_DATETIME_FORMAT" %}
    </div>
    <table class="table" border="1">
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Service</th>
                            <th>Books</th>
                        </tr>
                        {%for user in context.users%}
                            <tr>
                                <td>{{ user.id }}</td>
                                <td>{{ user.username }}</td>
                                <td>{{ user.email }}</td>
                                <td>{{user.profile.service}}</td>
                                <td>
                                {%for book in context.library%}
                                {%if book.id_user_id == user.id %}
                                {%for book_name in context.books%}
                                
                                {%if book_name.id == book.id_book_id %}
                                {{book_name.name}}

                            
                                {%endif%}
                                {%endfor%}
                                {% if forloop.last %}
                                .
                                {%else%}
                                ,
                                {%endif%}
                                {%endif%}
                                {%endfor%}
                            </td>
                            {%endfor%}

                        </tr>
                    </table>
    <div id="footer_content">
    </div>
    </body>
    </html>